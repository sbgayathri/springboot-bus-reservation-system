<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Navigation Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .section { margin: 20px 0; padding: 20px; border: 1px solid #ccc; }
        button { padding: 10px 20px; margin: 10px; background: #007bff; color: white; border: none; cursor: pointer; }
        button:hover { background: #0056b3; }
        .result { margin: 10px 0; padding: 10px; background: #f8f9fa; border-left: 3px solid #007bff; }
    </style>
</head>
<body>
    <h1>Bus Booking Navigation Debug Tool</h1>
    
    <div class="section">
        <h2>üîç Check Current Issues</h2>
        <p>This tool helps debug the navigation issue from Browse Buses to Book Bus page.</p>
        <button onclick="testLocalStorage()">Check User Authentication</button>
        <button onclick="testNavigation()">Test Navigation URL</button>
        <button onclick="openBrowsePage()">Open Browse Buses Page</button>
        <button onclick="openBookingPage()">Test Booking Page Direct</button>
        <div id="authResult" class="result" style="display:none;"></div>
        <div id="navResult" class="result" style="display:none;"></div>
    </div>

    <div class="section">
        <h2>üìã Common Issues & Solutions</h2>
        <ul>
            <li><strong>Authentication Issue:</strong> User not logged in - check localStorage for user data</li>
            <li><strong>Route Not Found:</strong> React Router path mismatch - verify /buses/user/book route exists</li>
            <li><strong>Button Click Not Working:</strong> onClick handler not properly attached - check console errors</li>
            <li><strong>Navigation State Lost:</strong> useNavigate hook not working - check React Router setup</li>
        </ul>
    </div>

    <div class="section">
        <h2>üõ†Ô∏è Debug Steps</h2>
        <ol>
            <li>Check if user is logged in (localStorage should have user data)</li>
            <li>Open browser console (F12) and go to Browse Buses page</li>
            <li>Click "Book Now" button and watch console logs</li>
            <li>Look for the debug messages we added: üöå, üë§, ‚úÖ, üöÄ</li>
            <li>If no logs appear, the button click isn't working</li>
            <li>If logs appear but no navigation, check React Router</li>
        </ol>
    </div>

    <script>
        function testLocalStorage() {
            const authDiv = document.getElementById('authResult');
            const user = localStorage.getItem('user');
            const token = localStorage.getItem('token');
            
            if (user && token) {
                try {
                    const userData = JSON.parse(user);
                    authDiv.innerHTML = `
                        <h4>‚úÖ User is logged in</h4>
                        <p><strong>Username:</strong> ${userData.username || 'Not found'}</p>
                        <p><strong>Role:</strong> ${userData.role || 'Not found'}</p>
                        <p><strong>Token exists:</strong> Yes (${token.substring(0, 20)}...)</p>
                    `;
                    authDiv.style.backgroundColor = '#d4edda';
                    authDiv.style.borderColor = '#28a745';
                } catch (e) {
                    authDiv.innerHTML = `
                        <h4>‚ö†Ô∏è User data corrupted</h4>
                        <p>User data exists but is not valid JSON</p>
                        <p><strong>Raw data:</strong> ${user}</p>
                    `;
                    authDiv.style.backgroundColor = '#fff3cd';
                    authDiv.style.borderColor = '#ffc107';
                }
            } else {
                authDiv.innerHTML = `
                    <h4>‚ùå User not logged in</h4>
                    <p>No user data found in localStorage</p>
                    <p><strong>User data:</strong> ${user || 'null'}</p>
                    <p><strong>Token:</strong> ${token || 'null'}</p>
                `;
                authDiv.style.backgroundColor = '#f8d7da';
                authDiv.style.borderColor = '#dc3545';
            }
            authDiv.style.display = 'block';
        }

        function testNavigation() {
            const navDiv = document.getElementById('navResult');
            navDiv.innerHTML = `
                <h4>üîó Navigation URLs</h4>
                <p><strong>Current URL:</strong> ${window.location.href}</p>
                <p><strong>Browse Buses:</strong> <a href="http://localhost:3000/user/browse-buses" target="_blank">http://localhost:3000/user/browse-buses</a></p>
                <p><strong>Book Bus (with ID):</strong> <a href="http://localhost:3000/buses/user/book/1" target="_blank">http://localhost:3000/buses/user/book/1</a></p>
                <p><strong>Book Bus (with ID 2):</strong> <a href="http://localhost:3000/buses/user/book/2" target="_blank">http://localhost:3000/buses/user/book/2</a></p>
                <p><strong>Login:</strong> <a href="http://localhost:3000/auth" target="_blank">http://localhost:3000/auth</a></p>
                <p style="margin-top: 15px; padding: 10px; background: #e7f3ff; border-left: 3px solid #007bff;">
                    <strong>‚úÖ Updated:</strong> Now navigation should go to <code>/buses/user/book/busId</code> with the actual bus ID in the URL.
                </p>
            `;
            navDiv.style.display = 'block';
        }

        function openBrowsePage() {
            window.open('http://localhost:3000/user/browse-buses', '_blank');
        }

        function openBookingPage() {
            window.open('http://localhost:3000/buses/user/book/1', '_blank');
        }
    </script>
</body>
</html>
